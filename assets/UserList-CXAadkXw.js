const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.esm-CmUJofG9.js","assets/index-BeQ7HviX.js","assets/index-BHoIooKj.css"])))=>i.map(i=>d[i]);
import{R as E,_ as C,j as e,r as x,U as R}from"./index-BeQ7HviX.js";import{B as N}from"./Button-fVZkOBa9.js";const I=()=>{const[t,n]=E.useState(typeof window<"u"&&window.innerWidth<640?70:48);return E.useEffect(()=>{const a=()=>{n(window.innerWidth<640?70:48)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),t},S=50,D=({users:t,onRowClick:n,sortBy:a,sortOrder:c,onSort:h})=>{const o=I(),s=r=>{h(r)},g=(r,l)=>e.jsxs("tr",{style:l,className:"hover:bg-blue-50 cursor-pointer focus-visible:ring-2 focus-visible:ring-blue-400",onClick:()=>n(r),tabIndex:0,role:"button","aria-label":`View details for ${r.name}`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),n(r))},children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.email}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.phone})]},r.id),p=(r,l)=>e.jsxs("div",{style:{...l,display:"grid",gridTemplateColumns:"minmax(120px,1fr) minmax(240px,2.5fr) minmax(120px,1fr)",width:"100%",alignItems:"center",boxSizing:"border-box",borderBottom:"1px solid #d1d5db",background:"#fff",outline:"none",transition:"background 0.2s"},className:"hover:bg-blue-50 cursor-pointer focus-visible:ring-2 focus-visible:ring-blue-400",onClick:()=>n(r),tabIndex:0,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),n(r))},children:[e.jsx("div",{style:{padding:"0 1rem",height:o-2,display:"flex",alignItems:"center",borderRight:"1px solid #d1d5db",overflowWrap:"break-word",wordBreak:"break-all"},children:r.name}),e.jsx("div",{style:{padding:"0 1rem",height:o-2,display:"flex",alignItems:"center",borderRight:"1px solid #d1d5db",overflowWrap:"break-word",wordBreak:"break-all"},children:r.email}),e.jsx("div",{style:{padding:"0 1rem",height:o-2,display:"flex",alignItems:"center",overflowWrap:"break-word",wordBreak:"break-all"},children:r.phone})]},r.id),[m,u]=E.useState(null);E.useEffect(()=>{let r=!0;return t.length>S?C(()=>import("./index.esm-CmUJofG9.js"),__vite__mapDeps([0,1,2])).then(l=>{r&&u(()=>l.FixedSizeList)}):u(null),()=>{r=!1}},[t.length]);const b=({index:r,style:l})=>{const i=t[r];return i?p(i,l):null},f=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phone",label:"Phone"}],y=(r=!1)=>r?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"minmax(120px,1fr) minmax(240px,2.5fr) minmax(120px,1fr)",fontWeight:600,background:"#f9fafb",borderBottom:"1px solid #d1d5db",minHeight:o,alignItems:"center",position:"sticky",top:0,zIndex:2},children:f.map((l,i)=>e.jsxs("div",{style:{padding:"0 1rem",height:o-2,display:"flex",alignItems:"center",borderRight:i<f.length-1?"1px solid #d1d5db":void 0,cursor:"pointer",userSelect:"none"},tabIndex:0,"aria-sort":a===l.key?c==="asc"?"ascending":"descending":"none",onClick:()=>s(l.key),onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),s(l.key))},children:[l.label,a===l.key?c==="asc"?" ▲":" ▼":""]},l.key))}):e.jsx("thead",{children:e.jsx("tr",{children:f.map(l=>e.jsxs("th",{onClick:()=>s(l.key),className:"cursor-pointer border border-gray-300 px-4 py-2 text-left select-none","aria-sort":a===l.key?c==="asc"?"ascending":"descending":"none",tabIndex:0,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),s(l.key))},children:[l.label,a===l.key?c==="asc"?" ▲":" ▼":""]},l.key))})});return e.jsx("div",{className:"overflow-x-auto w-full",role:"region","aria-label":"User Table",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300 table-auto","aria-label":"User List",role:"table",children:[t.length>S&&m?null:y(!1),e.jsxs("tbody",{children:[t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-4 text-center text-gray-500",children:"No users found."})}),t.length>S&&m?e.jsx("tr",{children:e.jsx("td",{colSpan:3,style:{padding:0,border:"none"},children:e.jsxs("div",{style:{width:"100%"},children:[y(!0),e.jsx(m,{height:Math.min(t.length,10)*o,itemCount:t.length,itemSize:o,width:"100%",role:"listbox","aria-label":"Virtualized User List",children:b})]})})}):t.map(r=>g(r))]})]})})},U=({search:t,onSearchChange:n,sortBy:a,sortOrder:c,onSortChange:h})=>{const o=s=>{h(s)};return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by Name or Email",value:t,onChange:s=>n(s.target.value),"aria-label":"Search",className:"border border-gray-300 rounded px-3 py-2 w-full md:w-64"}),e.jsx("div",{className:"flex gap-4",children:["name","email"].map(s=>e.jsxs(N,{onClick:()=>o(s),className:a===s?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-200","aria-pressed":a===s,children:["Sort by ",s," ",a===s?c==="asc"?"▲":"▼":""]},s))})]})},T=({user:t,isOpen:n,onClose:a})=>{const c=x.useRef(null);return x.useEffect(()=>{function h(o){if(o.key==="Escape"&&n&&a(),o.key==="Tab"&&n&&c.current){const s=c.current.querySelectorAll('a, button, textarea, input, select, [tabindex]:not([tabindex="-1"])');if(s.length===0)return;const g=s[0],p=s[s.length-1];!o.shiftKey&&document.activeElement===p?(o.preventDefault(),g.focus()):o.shiftKey&&document.activeElement===g&&(o.preventDefault(),p.focus())}}return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[n,a]),n?e.jsx("div",{className:"fixed inset-0 bg-white/70 flex items-center justify-center z-50",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-desc",tabIndex:-1,onClick:a,children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6 shadow-lg",onClick:h=>h.stopPropagation(),ref:c,tabIndex:0,"aria-label":`User details for ${t.name}`,children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-bold mb-4",tabIndex:0,children:t.name}),e.jsxs("div",{id:"modal-desc",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("a",{href:`mailto:${t.email}`,children:t.email})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",e.jsx("a",{href:`tel:${t.phone}`,children:t.phone})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",t.address.street,", ",t.address.suite,","," ",t.address.city,", ",t.address.zipcode,t.address.geo&&t.address.geo.lat&&t.address.geo.lng&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`https://www.google.com/maps?q=${t.address.geo.lat},${t.address.geo.lng}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline ml-2","aria-label":`View ${t.name}'s address on Google Maps`,children:"View on Map"})]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",t.company.name]})]}),e.jsx(N,{onClick:a,className:"mt-4 bg-blue-600 text-white hover:bg-blue-700","aria-label":"Close user details dialog",autoFocus:!0,children:"Close"})]})}):null},_=()=>e.jsxs("div",{role:"status",className:"flex justify-center p-8",children:[e.jsx("svg",{"aria-hidden":"true",className:"w-8 h-8 text-gray-700 animate-spin dark:text-gray-900",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M50 15a35 35 0 1 1-24.75 10.25",stroke:"currentColor",strokeWidth:"10",strokeLinecap:"round",fill:"none"})}),e.jsx("span",{className:"sr-only",children:"Loading..."})]}),z=({message:t})=>e.jsxs("div",{role:"alert",className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[e.jsx("strong",{className:"font-bold",children:"Error: "}),e.jsx("span",{className:"block sm:inline",children:t})]});function H(t,n){const[a,c]=x.useState(t);return x.useEffect(()=>{const h=setTimeout(()=>{c(t)},n);return()=>{clearTimeout(h)}},[t,n]),a}const V=()=>{const{state:t,dispatch:n}=x.useContext(R),{users:a,loading:c,error:h,modalUser:o}=t,[s,g]=x.useState(""),p=H(s,300),[m,u]=x.useState("name"),[b,f]=x.useState("asc");x.useEffect(()=>{a.length===0&&(n({type:"SET_LOADING",payload:!0}),fetch("https://jsonplaceholder.typicode.com/users").then(d=>{if(!d.ok)throw new Error("Network response not OK");return d.json()}).then(d=>{n({type:"SET_USERS",payload:d})}).catch(()=>{n({type:"SET_ERROR",payload:"Failed to fetch users"})}))},[n,a.length]);const y=x.useMemo(()=>{let d=a.filter(w=>w.name.toLowerCase().includes(p.toLowerCase())||w.email.toLowerCase().includes(p.toLowerCase()));return d.sort((w,L)=>{const j=w[m],k=L[m];let v=0;return typeof j=="string"&&typeof k=="string"?v=j.localeCompare(k):typeof j=="number"&&typeof k=="number"&&(v=j-k),b==="asc"?v:-v}),d},[a,p,m,b]),r=d=>{d===m?f(b==="asc"?"desc":"asc"):(u(d),f("asc"))},l=d=>{n({type:"OPEN_MODAL",payload:d})},i=()=>{n({type:"CLOSE_MODAL"})};return e.jsxs("div",{className:"p-4 max-w-5xl mx-auto",role:"main","aria-label":"User List Page",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",tabIndex:0,"aria-label":"User List Heading",children:"User List"}),h&&e.jsx(z,{message:h}),e.jsx(U,{search:s,onSearchChange:g,sortBy:m,sortOrder:b,onSortChange:r}),c?e.jsx(_,{}):e.jsx(D,{users:y,onRowClick:l,sortBy:m,sortOrder:b,onSort:r}),o&&e.jsx(T,{user:o,isOpen:!!o,onClose:i})]})};export{V as default};
